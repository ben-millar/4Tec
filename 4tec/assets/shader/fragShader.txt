uniform sampler2D texture;

uniform float windowWidth;
uniform float windowHeight;

uniform float tableWidth;

uniform float relativeLayerHeight;

void main()
{
    // lookup the pixel in the texture
    vec4 pixel = texture2D(texture, gl_TexCoord[0].xy);

    vec2 coord  = gl_FragCoord.xy / vec2(windowWidth,windowHeight); // pixel coord

    int pixelBuffer = 7;

    if (gl_FragCoord.x > pixelBuffer && gl_FragCoord.x < tableWidth - pixelBuffer)
    {
        float distFromTopOfLayer;
        if (coord.y >  1 - relativeLayerHeight)
            distFromTopOfLayer = 1 - coord.y;
        else if (coord.y > 1 - relativeLayerHeight * 2)
            distFromTopOfLayer = 1 - (coord.y + relativeLayerHeight);
        else if (coord.y > 1- relativeLayerHeight * 3)
            distFromTopOfLayer = 1 - (coord.y + relativeLayerHeight * 2);
        else if (coord.y > 1 - relativeLayerHeight * 4)
            distFromTopOfLayer = 1 - (coord.y + relativeLayerHeight * 3);

        float max = 5;
        float min = 0.4;

        float final = distFromTopOfLayer * max + min;
        pixel *= vec4(final,final,final,1);
    }

    gl_FragColor = pixel; 
};